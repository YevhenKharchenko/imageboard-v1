{"version":3,"file":"commonHelpers.js","sources":["../src/js/main.js"],"sourcesContent":["import { initializeApp } from 'firebase/app';\nimport {\n  getFirestore,\n  collection,\n  getDocs,\n  onSnapshot,\n  addDoc,\n  deleteDoc,\n  doc,\n  orderBy,\n  serverTimestamp,\n  query,\n  where,\n  getDoc,\n  updateDoc,\n} from 'firebase/firestore';\n// import 'modern-normalize';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst gallery = document.querySelector('.gallery');\nconst form = document.querySelector('.form');\n\nconst firebaseConfig = {\n  apiKey: import.meta.env.VITE_API_KEY,\n  authDomain: import.meta.env.VITE_AUTH_DOMAIN,\n  projectId: import.meta.env.VITE_PROJECT_ID,\n  storageBucket: import.meta.env.VITE_STORAGE_BUCKET,\n  messagingSenderId: import.meta.env.VITE_MESSAGING_SENDER_ID,\n  appId: import.meta.env.VITE_APP_ID,\n};\n\ninitializeApp(firebaseConfig);\n\nconst db = getFirestore();\nconst colRef = collection(db, 'posts');\nconst q = query(colRef, orderBy('createdAt', 'asc'));\n\nform.addEventListener('submit', onPostBtnClick);\n\nasync function onPostBtnClick(e) {\n  e.preventDefault();\n\n  const { value } = e.currentTarget.elements.post;\n\n  if (!value.trim()) return;\n\n  await postMessage(value);\n\n  e.target.elements.post.value = '';\n}\n\nasync function getPosts() {\n  const snapshot = await getDocs(q);\n\n  let posts = [];\n\n  snapshot.docs.forEach(doc => {\n    posts.push({ ...doc.data(), id: doc.id });\n  });\n\n  renderPosts(posts);\n}\n\nonSnapshot(q, getPosts);\n\nasync function postMessage(message) {\n  const date = new Date();\n\n  const post = await addDoc(colRef, {\n    title: message,\n    date: date.toString().substring(0, 24),\n    createdAt: serverTimestamp(),\n  });\n}\n\nasync function deleteMessage(post) {\n  const docRef = doc(db, 'posts', post);\n\n  await deleteDoc(docRef);\n}\n\nfunction renderPosts(posts) {\n  const markup = posts\n    .map(({ id, title, date }) => {\n      return `\n      <li class=\"gallery-item\" id=\"${id}\">\n        <div class=\"title-wrapper\">\n          <p><b>Anonymous</b> ${date}</p>\n          <button class=\"delete-btn\">del</button>\n        </div>\n        <p class=\"item-text\">${title}</p>\n      </li>`;\n    })\n    .join('');\n\n  gallery.innerHTML = markup;\n\n  const deleteBtns = document.querySelectorAll('.delete-btn');\n\n  deleteBtns.forEach(btn => {\n    btn.addEventListener('click', e => {\n      const postElem = e.target.parentNode.parentNode;\n      deleteMessage(postElem.getAttribute('id'));\n      postElem.remove();\n    });\n  });\n}\n"],"names":["gallery","form","firebaseConfig","initializeApp","db","getFirestore","colRef","collection","q","query","orderBy","onPostBtnClick","e","value","postMessage","getPosts","snapshot","getDocs","posts","doc","renderPosts","onSnapshot","message","addDoc","serverTimestamp","deleteMessage","post","docRef","deleteDoc","markup","id","title","date","btn","postElem"],"mappings":"4zBAoBA,MAAMA,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAO,SAAS,cAAc,OAAO,EAErCC,EAAiB,CACrB,OAAQ,0CACR,WAAY,iCACZ,UAAW,iBACX,cAAe,6BACf,kBAAmB,eACnB,MAAO,2CACT,EAEAC,EAAcD,CAAc,EAE5B,MAAME,EAAKC,EAAY,EACjBC,EAASC,EAAWH,EAAI,OAAO,EAC/BI,EAAIC,EAAMH,EAAQI,EAAQ,YAAa,KAAK,CAAC,EAEnDT,EAAK,iBAAiB,SAAUU,CAAc,EAE9C,eAAeA,EAAeC,EAAG,CAC/BA,EAAE,eAAc,EAEhB,KAAM,CAAE,MAAAC,CAAK,EAAKD,EAAE,cAAc,SAAS,KAEtCC,EAAM,KAAI,IAEf,MAAMC,EAAYD,CAAK,EAEvBD,EAAE,OAAO,SAAS,KAAK,MAAQ,GACjC,CAEA,eAAeG,GAAW,CACxB,MAAMC,EAAW,MAAMC,EAAQT,CAAC,EAEhC,IAAIU,EAAQ,CAAA,EAEZF,EAAS,KAAK,QAAQG,GAAO,CAC3BD,EAAM,KAAK,CAAE,GAAGC,EAAI,KAAM,EAAE,GAAIA,EAAI,EAAE,CAAE,CAC5C,CAAG,EAEDC,EAAYF,CAAK,CACnB,CAEAG,EAAWb,EAAGO,CAAQ,EAEtB,eAAeD,EAAYQ,EAAS,CAGrB,MAAMC,EAAOjB,EAAQ,CAChC,MAAOgB,EACP,KAJW,IAAI,OAIJ,SAAQ,EAAG,UAAU,EAAG,EAAE,EACrC,UAAWE,EAAiB,CAChC,CAAG,CACH,CAEA,eAAeC,EAAcC,EAAM,CACjC,MAAMC,EAASR,EAAIf,EAAI,QAASsB,CAAI,EAEpC,MAAME,EAAUD,CAAM,CACxB,CAEA,SAASP,EAAYF,EAAO,CAC1B,MAAMW,EAASX,EACZ,IAAI,CAAC,CAAE,GAAAY,EAAI,MAAAC,EAAO,KAAAC,CAAI,IACd;AAAA,qCACwBF,CAAE;AAAA;AAAA,gCAEPE,CAAI;AAAA;AAAA;AAAA,+BAGLD,CAAK;AAAA,YAE/B,EACA,KAAK,EAAE,EAEV/B,EAAQ,UAAY6B,EAED,SAAS,iBAAiB,aAAa,EAE/C,QAAQI,GAAO,CACxBA,EAAI,iBAAiB,QAAS,GAAK,CACjC,MAAMC,EAAW,EAAE,OAAO,WAAW,WACrCT,EAAcS,EAAS,aAAa,IAAI,CAAC,EACzCA,EAAS,OAAM,CACrB,CAAK,CACL,CAAG,CACH"}